# CSS filter 除了可以实现自己的instragram，还有哪些神奇用途

![16.0](http://127.0.0.1:8080/%23css/images/16.0.png)

## 背景

filter CSS属性将模糊或颜色偏移等图形效果应用于元素。滤镜通常用于调整图像，背景和边框的渲染。
CSS 标准里包含了一些已实现预定义效果的函数。你也可以参考一个 SVG 滤镜，通过一个 URL 链接到 SVG 滤镜元素(SVG filter element)。

<filter-function>
 <filter-function> CSS 数据类型 代表可以改变输入图像外观的图形效果。它可以用于filter 和 backdrop-filter 属性。
语法
<filter-function> 数据类型由下列过滤器函数之一指定的。每个函数需要一个参数，如果参数无效，结果不会被改变，如同没有使用过滤器一样。
```
blur()
模糊图像
brightness()
让图像更明亮或更暗淡
contrast()
增加或减少图像的对比度
drop-shadow()
在图像后方应用投影
grayscale()
将图像转为灰度图
hue-rotate()
改变图像的整体色调
invert()
反转图像颜色
opacity()
改变图像透明度
saturate()
超饱和或去饱和输入的图像
sepia()
将图像转为棕褐色
```

### 基本语法

```css
/* URL to SVG filter */
filter: url("filters.svg#filter-id");
/* <filter-function> values */
filter: blur(5px);
filter: brightness(0.4);
filter: contrast(200%);
filter: drop-shadow(16px 16px 20px blue);
filter: grayscale(50%);
filter: hue-rotate(90deg);
filter: invert(75%);
filter: opacity(25%);
filter: saturate(30%);
filter: sepia(60%);
/* Multiple filters */
filter: contrast(175%) brightness(3%);
/* Use no filter */
filter: none;
/* Global values */
filter: inherit;
filter: initial;
filter: unset;
设置一种函数，方法如下：
filter: <filter-function> [<filter-function>]* | none
给SVG元素 <filter> 引用滤镜, 如下：
filter: url(file.svg#filter-element-id)
```

## 案例

### 更加智能的阴影

Applies a drop shadow effect to the input image. A drop shadow is effectively a blurred, offset version of the input image’s alpha mask drawn in a particular color, composited below the image. The function accepts a parameter of type (defined in CSS3 Backgrounds), with the exception that the ‘inset’ keyword is not allowed.

This function is similar to the more established box-shadow property; the difference is that with filters, some browsers provide hardware acceleration for better performance.

Drop-shadow also mimics the intended objects outline naturally unlike box-shadow that treats only the box as its path.

和 `box-shadow` 相比 `drop-shadow()` 可以穿透透明图层，可以将阴影加在图片实体图像中，而box-shadow只能给容器添加阴影。

drop-shadow语法如下：

```css
filter: drop-shadow(x偏移, y偏移, 模糊大小, 色值);
```

如：

```css
filter:drop-shadow(-25px 25px 25px rgba(26,58,70,0.7));
```

![16.1](http://127.0.0.1:8080/%23css/images/16.1.png)

```html
<div class="tri drop-shadow">filter: drop-shadow</div>
<div class="tri box-shadow">box-shadow</div>
<div style="clear:both"></div>
<div class="flecha drop-shadow"></div>
<div class="flecha box-shadow"></div>
```

```css
body{
  background: #D5D5D5;
  font-family: museo-300;
  font-size: 1.5rem;
  text-align: center;
}
.tri, .flecha {display: inline-block;margin: 15px;}

.tri {
text-align: left;
width: 250px;
height: 100px;
background: #fff;
position: relative;
padding: 15px;
box-sizing: border-box;
}
.tri:after {
content:'';
height: 0;
width: 0;
border-width: 20px 20px 20px 0;
border-style: solid;
border-color: rgba(255,255,255,0) rgba(255,255,255,1) rgba(255,255,255,0) rgba(255,255,255,0);
position: absolute;
top: 15px;
left: -20px;
}

.flecha {
  position: relative;
  margin: -20px 110px 0;
  width: 0;
  height: 0;
  border-top: 90px solid transparent;
  border-right: 90px solid #FFC000;
  -webkit-transform: rotate(10deg);
  -moz-transform: rotate(10deg);
  -ms-transform: rotate(10deg);
  -o-transform: rotate(10deg);
}
.flecha:after {
  content: "";
  position: absolute;
  border: 0 solid transparent;
  border-top: 30px solid #FFC000;
  border-radius: 200px 0 0 0;
  top: -119px;
  left: -98px;
  width: 120px;
  height: 120px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
.drop-shadow {
    filter: drop-shadow(0px 0px 10px rgba(0,0,0,.5));
    }
.box-shadow {box-shadow: 0px 0px 10px rgba(0,0,0,.5)}
```

## 毛玻璃效果

```html
<header>
<!--
	Need an element to contain the blur if
	you want a sharp edge.
	If using header::after, for example, the
	edge itself gets blurred with the image.
-->
	<div class="window"></div>
	<h1>Using filter: blur()</h1>
</header>

<main>
	<p>Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header.</p>
	<p>Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header.</p>
	<p>Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header.</p>
	<p>Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header. Content continues on as normal after the header.</p>
</main>

<!--
This is an alternate option, using backdrop-filter. Does exactly the trick, but less supported
-->
<footer>
	<h1>Using backdrop-filter: blur()</h1>
</footer>
```

```less
// Setting up the header
header,
footer {
	height: 100vh;
	width: 100%; // not using 100vw in case of scrollbars
	display: flex;
	justify-content: center;
	align-items: center;
	background-color: #000;
	color: #fff;
	box-shadow: 0 0 1rem #0006;
}
// make sure any contents go over .window
header,
footer {
	> * {
		z-index: 3;
	}
}

// Have to use two overlapping instances of the same background image
header,
footer,
.window::after {
	background-image: url(https://picsum.photos/id/424/1500/900);
	background-size: cover;
	background-position: top left;
	background-attachment: fixed;
}
// .window just a container
.window {
	// border just makes the edge a little sharper
	border-right: 1px solid #fff3;
	// and this keeps the blur from bleeding out over the rest
	overflow: hidden;
	&,
	&::after {
		position: absolute;
		left: 0;
		top: 0;
		height: 100vh;
		width: 50%;
	}
}
.window::after {
	content: "";
	display: block;
	width: 100%; // 100% of .window, that is

	// and, finally, here's the important line.
	filter: blur(0.5rem);
}

// Alternate version with less browser support
footer {
	background-image: url(https://picsum.photos/id/402/1500/900);
	&::before {
		content: "";
		display: block;
		position: absolute;
		left: 0;
		width: 50%;
		height: 100%;
		background-color: #fff3;
		border-right: 1px solid #fff6;
		// and this is the key part
		-webkit-backgdrop-filter: blur(0.5em);
		backdrop-filter: blur(0.5em);
		// browser support varies, though.
	}
}

// and this is all secondary.
h1 {
	font-size: 2rem;
	@media screen and (min-width: 40rem) {
		font-size: 4rem;
	}
	font-weight: 400;
	letter-spacing: 0.08em;
	font-family: Georgia, sans-serif;
	text-shadow: 0 0.08em 0.1em #0009;
}
main {
	max-width: 32rem;
	margin: 2rem auto;
	padding: 1rem;
}
html {
	overflow-y: scroll;
}

// Just some template defaults.
*,
*::before,
*::after {
	box-sizing: inherit;
}
html {
	height: 100%;
}
body {
	min-height: 100%;
	margin: 0;
	font-family: sans-serif;
	line-height: 1.5;
	box-sizing: border-box;
}
img,
svg {
	display: block;
	max-width: 100%;
	height: auto;
}

```

![16.2](http://127.0.0.1:8080/%23css/images/16.2.png)
![16.3](http://127.0.0.1:8080/%23css/images/16.3.png)

## 毛玻璃效果-透明边框

![16.4](http://127.0.0.1:8080/%23css/images/16.4.png)

```html
<div>I'm an element with a blurry border. This is created with an actual border on the pseudo-elements, the :before being blurred and :after clipped to the padding-box.</div>
```

```scss
$url: url(https://images.unsplash.com/photo-1544070078-a212eda27b49?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&ixid=eyJhcHBfaWQiOjE0NTg5fQ);
$b: 1.5em; // border-width
$blur: blur(9px);

div {
  overflow: hidden;
  position: relative;
  padding: calc(1em + #{$b});
  max-width: 23em;
  color: #fff;
  font: 600 1.5em/ 1.375 segoe script, comic sans ms, cursive;
  text-shadow: 1px 1px #000;
  
  &:before, &:after {
    position: absolute;
    z-index: -1; /* put it *behind* parent */
    /* zero all offsets */
    top: 0; right: 0; bottom: 0; left: 0;
    border: solid $b rgba(#000, .03);
    background: $url 50%/ cover 
                  border-box /* background-origin */
                  padding-box /* background-clip */;
    content: ''
  }
  
  &:before {
    border-color: transparent;
    background-clip: border-box;
    /* -webkit-prefixed version 
     * still needed for 
     * some mobile browsers 💔😭 */
    -webkit-filter: $blur;
            filter: $blur;
  }
}
```

## 置灰

```html

<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style type="text/css">
    .box {
      height: 200px;
      width: 200px;
      background: #03C03C;
    }
    .gray-filter {
      filter: grayscale(100%);
      -webkit-filter: grayscale(100%);
      -moz-filter: grayscale(100%);
      -ms-filter: grayscale(100%);
      -o-filter: grayscale(100%);
      filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale");
      filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
      -webkit-filter: grayscale(1);
    }
  </style>
</head>
<body>
  <div class="box"></div>
  <script>
    (function setGray() {
      // 结束时间时间戳
      var endTime = Date.parse("Apr 06 2022 00:00:01");
      var timestamp = Date.parse(new Date());
      if (timestamp <= endTime) {
        document.querySelector('html').classList.add('gray-filter');
      }
    })();
  </script>
</body>
</html>
```

## 简易insatagram

![16.instagram](http://127.0.0.1:8080/%23css/images/16.instagram.png)

```html
<h1>Image Editor with CSS Filters and jQuery</h1>
		
<!--Form for collecting image URL -->
<form id="urlBox" class="center">
  <input class="url-box" type="url" id="imgUrl" placeholder="Paste any image link and start playing!">
  <input id="go" type="button" value="Go">
</form>

<hr color="grey">

<!--Controls for CSS filters via range input-->
<div class="sliders">
  <form id="imageEditor">
    <p>
      <label for="gs">Grayscale</label>
      <input id="gs" name="gs" type="range" min="0" max="100" value="0">
    </p>

    <p>
      <label for="blur">Blur</label>
      <input id="blur" name="blur" type="range" min="0" max="10" value="0">
    </p>

    <p>
      <label for="br">Exposure</label>
      <input id="br" name="br" type="range" min="0" max="200" value="100">
    </p>

    <p>
      <label for="ct">Contrast</label>
      <input id="ct" name="ct" type="range" min="0" max="200" value="100">
    </p>

    <p>
      <label for="huer">Hue Rotate</label>
      <input id="huer" name="huer" type="range" min="0" max="360" value="0">
    </p>

    <p>
      <label for="opacity">Opacity</label>
      <input id="opacity" name="opacity" type="range" min="0" max="100" value="100">
    </p>

    <p>
      <label for="invert">Invert</label>
      <input id="invert" name="invert" type="range" min="0" max="100" value="0">
    </p>

    <p>
      <label for="saturate">Saturate</label>
      <input id="saturate" name="saturate" type="range" min="0" max="500" value="100">
    </p>

    <p>
      <label for="sepia">Sepia</label>
      <input id="sepia" name="sepia" type="range" min="0" max="100" value="0">
    </p>

    <input type="reset" form="imageEditor" id="reset" value="Reset" />

  </form>
</div>	

<!--container where image will be loaded-->
<div id="imageContainer" class="center">
  <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/123941/stadium.jpg">
</div>

<p class="p">Demo by Vikas Lalwani. <a href="http://www.sitepoint.com/build-simple-image-editor-with-css-filters-jquery" target="_blank">See article</a>.</p>

```

```css
/* General styles for the page */ 
* {
  margin: 0;
  padding: 0;
}

body {
  background-color: #D2D7D3;
  font-family: monospace;
  margin: 0 auto;
  width: 960px;
}

h1 {
  margin: 25px 0 25px 0;
  font-size: 40px;
  text-align: center;
}

hr {
  margin: 20px 0;
}

form {
  text-align: center;
}

/* Styles for  URL box */ 

.url-box {
  background-color: transparent;
  display: inline-block;
  height: 30px;
  border: none;
  border-bottom: 4px solid #b3b3b1;
  padding: 0px 0px 0px 20px;
  margin: 0px 0px;
  width: 50%;
  outline: none;
  text-align: center;
  font-size: 15px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
}

#go {
  display: inline-block;
  height: 50px;
  width: 50px;
  background-color: transparent;
  padding: 0px;
  border: 4px solid #b3b3b1;
  border-radius: 50%;
  box-shadow: none;
  cursor: pointer;
  outline: none;
  text-align: center;
  font-size: 20px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
}

/* Styles for image container*/

#imageContainer {
  border: 2px solid grey;
  border-radius: 10px;
  padding: 5px;
  width: 65%;
  max-width: 600px;
  float: left;
  margin: 20px;
}

#imageContainer img {
  border-radius: 10px;
  width: 100%;
}

/* Styles for sliders*/

.sliders {
  float: left;
  border: 2px solid grey;
  border-radius: 10px;
  margin-top: 20px;
  margin-bottom: 20px;
  padding-left: 10px;
}

.sliders p {
  margin: 18px 0;
  vertical-align: middle;
}

.sliders label {
  display: inline-block;
  margin: 10px 0 0 0;
  width: 100px;
  font-size: 16px;
  color: #22313F;
  text-align: left;
  vertical-align: middle;
}

.sliders input {
  position: relative;
  margin: 10px 20px 0 10px;
  vertical-align: middle;
}

input[type=range] {
  /*removes default webkit styles*/
  -webkit-appearance: none;
  /*fix for FF unable to apply focus style bug */
  border-radius: 5px;
  /*required for proper track sizing in FF*/
  width: 150px;
}

input[type=range]::-webkit-slider-runnable-track {
  width: 300px;
  height: 7px;
  background: #ABB7B7;
  border: none;
  border-radius: 3px;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  border: none;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: #4B77BE;
  margin-top: -6px;
  vertical-align: middle;
}
input[type=range]:focus {
  outline: none;
}

input[type=range]:hover {
	cursor: pointer;
}


#reset {
  display: inline-block;
  height: 40px;
  width: 100px;
  background-color: transparent;
  padding: 0px;
  border: 4px solid #b3b3b1;
  border-radius: 10px;
  box-shadow: none;
  cursor: pointer;
  outline: none;
  text-align: center;
  font-size: 20px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
  margin: 0 0 10px 0;
}

.p {
  clear: both;
  text-align: center;
  padding:  40px 0 40px;
}
```

```js
//on click of go(submit) button, addImage() will be called
$("#go").click(addImage);

//on pressing return, addImage() will be called
$("#urlBox").submit(addImage);


// editing image via css properties
function editImage() {
	var gs = $("#gs").val(); // grayscale
	var blur = $("#blur").val(); // blur
	var br = $("#br").val(); // brightness
	var ct = $("#ct").val(); // contrast
	var huer = $("#huer").val(); //hue-rotate
	var opacity = $("#opacity").val(); //opacity
	var invert = $("#invert").val(); //invert
	var saturate = $("#saturate").val(); //saturate
	var sepia = $("#sepia").val(); //sepia

	$("#imageContainer img").css(
    "filter", 'grayscale(' + gs+
    '%) blur(' + blur +
    'px) brightness(' + br +
    '%) contrast(' + ct +
    '%) hue-rotate(' + huer +
    'deg) opacity(' + opacity +
    '%) invert(' + invert +
    '%) saturate(' + saturate +
    '%) sepia(' + sepia + '%)'
  );

	$("#imageContainer img").css(
    "-webkit-filter", 'grayscale(' + gs+
    '%) blur(' + blur +
    'px) brightness(' + br +
    '%) contrast(' + ct +
    '%) hue-rotate(' + huer +
    'deg) opacity(' + opacity +
    '%) invert(' + invert +
    '%) saturate(' + saturate +
    '%) sepia(' + sepia + '%)'
  );
}

//When sliders change image will be updated via editImage() function
$("input[type=range]").change(editImage).mousemove(editImage);

// Reset sliders back to their original values on press of 'reset'
$('#imageEditor').on('reset', function () {
	setTimeout(function() {
		editImage();
	}, 0);
});

// adding an image via url box
function addImage(e) {
	var imgUrl = $("#imgUrl").val();
	if (imgUrl.length) {
		$("#imageContainer img").attr("src", imgUrl);
	}
	e.preventDefault();	
}
```

## 压缩体积

## 黑白照片视频复原

## 总结

哇塞，这也太哇塞了吧，CSS绝绝子，yyds
