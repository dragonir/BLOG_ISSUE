# `CSS filter` 有哪些神奇用途

![filter_0.png](http://127.0.0.1:8080/%23css/images/filter_0.png)

## 背景

### 定义

`filter` CSS属性将模糊或颜色偏移等图形效果应用于元素。滤镜通常用于调整图像，背景和边框的渲染。CSS 标准里包含了一些已实现预定义效果的函数。你也可以参考一个 SVG 滤镜，通过一个 URL 链接到 SVG 滤镜元素。

### filter函数

 `<filter-function>` CSS 数据类型 代表可以改变输入图像外观的图形效果。它可以用于 `filter` 和 `backdrop-filter` 属性。`<filter-function>` 数据类型由下列过滤器函数之一指定的。每个函数需要一个参数，如果参数无效，结果不会被改变，如同没有使用过滤器一样。

* `blur()`：模糊图像
* `brightness()` ：让图像更明亮或更暗淡
* `contrast()`：增加或减少图像的对比度
* `drop-shadow()`：在图像后方应用投影
* `grayscale()`：将图像转为灰度图
* `hue-rotate()`：改变图像的整体色调
* `invert()`：反转图像颜色
* `opacity()`：改变图像透明度
* `saturate()`：超饱和或去饱和输入的图像
* `sepia()`：将图像转为棕褐色

### 基本语法

设置filter函数：

```css
filter: <filter-function> [<filter-function>]* | none
```

给元素添加svg滤镜

```css
filter: url(file.svg#filter-element-id)
```

```css
/* 使用SVG filter */
filter: url("filters.svg#filter-id");
/* 使用filter函数 */
filter: blur(5px);
filter: brightness(0.4);
filter: contrast(200%);
filter: drop-shadow(16px 16px 20px blue);
filter: grayscale(50%);
filter: hue-rotate(90deg);
filter: invert(75%);
filter: opacity(25%);
filter: saturate(30%);
filter: sepia(60%);
/* 多个filter */
filter: contrast(175%) brightness(3%);
/* 不使用filter */
filter: none;
/* 全局变量 */
filter: inherit;
filter: initial;
filter: unset;
```

![16.1](http://127.0.0.1:8080/%23css/images/16.1.png)

## 应用案例

### 更加智能的阴影效果

在给元素添加阴影的时候，我们一般采用 `box-shadow` 属性，通过 `box-shadow(x偏移, y偏移, 模糊大小, 阴影大小, 色值, inset)` 的语法形式很容易为元素添加阴影效果，但 `box-shadow` 也有一个缺点，就是在给透明图片添加阴影效果时，无法穿透元素，只能添加到透明图片元素的盒模型上。这个时候，`filter` 属性的 `drop-shadow` 方法就能很好的解决这个问题，用它添加的阴影可以穿透元素，而不是添加到元素的盒模型边框上。

`drop-shadow` 添加的阴影除了可以穿透透明元素外，阴影效果和 `box-shadow` 是相同的，如果浏览器支持硬件加速的话，使用 `filter` 添加的阴影效果会更加逼真。

`drop-shadow` 语法如下（它除了不支持设置 `inset`，其他和 `box-shadow` 是完全相同的）：

```css
filter: drop-shadow(x偏移, y偏移, 模糊大小, 色值);
```

如：

```css
filter: drop-shadow(1px 1px 15px rgba(0, 0, 0, .5));
```

下图是分别使用 `box-shadow` 和 `filter: drop-shadow` 为透明元素添加阴影的对比：

![filter_3.png](http://127.0.0.1:8080/%23css/images/filter_3.png)

```html
<img class="box-shadow" src="futurama.png" />
<img class="drop-shadow" src="futurama.png" />
```

```css
.box-shadow {
  box-shadow: 1px 1px 15px rgba(0, 0, 0, .5);
}
.drop-shadow {
  filter: drop-shadow(1px 1px 15px rgba(0, 0, 0, .5));
}
```

### 元素或整改页面置灰

通过 

```css
filter: grayscale(100%);
```

```html
<body class="gray-filter">
  <h1 class="title">FUTURAMA</h1>
  <img class="img" width="500" src="./images/futurama.png" />
</body>
```

![filter_4.png](http://127.0.0.1:8080/%23css/images/filter_4.png)

```css
.gray {
  -webkit-filter: grayscale(100%);
  -moz-filter: grayscale(100%);
  -ms-filter: grayscale(100%);
  -o-filter: grayscale(100%);
  filter: grayscale(100%);
  filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
}
```

![filter_5.png](http://127.0.0.1:8080/%23css/images/filter_5.png)

支持ie8

```css
.gray-filter {
  -webkit-filter: grayscale(100%);
  -moz-filter: grayscale(100%);
  -ms-filter: grayscale(100%);
  -o-filter: grayscale(100%);
  filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale");
  filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1);
  -webkit-filter: grayscale(1);
  filter: grayscale(100%);
}

```

```javascript
(function setGray() {
  var endTime = Date.parse("Apr 06 2077 00:00:01");
  var timestamp = Date.parse(new Date());
  if (timestamp <= endTime) {
    document.querySelector('html').classList.add('gray-filter');
  }
})();
```

### 元素高亮

使用 brightness 可以轻松实现内容高亮

![16.1](http://127.0.0.1:8080/%23css/images/16.0.gif)

```html
<div class="container">
  <a class="button">🍋</a>
  <a class="button">🍎</a>
  <a class="button">🍐</a>
  <a class="button dark">🥑</a>
  <a class="button dark">🍄</a>
  <a class="button dark">🌽</a>
  <a class="button disabled">🍒</a>
  <a class="button disabled">🍅</a>
  <a class="button disabled">🥔</a>
</div>
```

```css
.container {
  margin: 40px;
}
.button {
  padding: 0.5em 0.5em;
  background: #E0E0E0;
  border-radius: 3px;
}
.button.dark {
  background: #333;
}
.button:hover:not(.disabled) {
  cursor: pointer;
  border-radius: 3px;
  filter: brightness(110%) saturate(140%);
}
.button.disabled {
  filter: grayscale(100%);
}
```

> 其他hover 效果 https://codepen.io/nxworld/details/ZYNOBZ
> 其他 按钮反色 https://codepen.io/monkey-company/pen/zZZvRp

## 毛玻璃效果

![filter_6](http://127.0.0.1:8080/%23css/images/filter_6.png)

```html
<div class="container">
  <div class="glass glass-by-filter"></div>
  <div class="glass glass-by-backdrop-filter"></div>
</div>
```

```css
.glass {
  height: 300px;
  width: 300px;
  border: 1px groove #EFEFEF;
  border-radius: 12px;
  background: rgba(242, 242, 242, 0.5);
  box-shadow: 0 0.3px 0.7px rgba(0, 0, 0, 0.126),
    0 0.9px 1.7px rgba(0, 0, 0, 0.179), 0 1.8px 3.5px rgba(0, 0, 0, 0.224),
    0 3.7px 7.3px rgba(0, 0, 0, 0.277), 0 10px 20px rgba(0, 0, 0, 0.4);
}
.glass-by-filter {
z-index: 1;
  box-sizing: border-box;
  position: relative;
}
.glass-by-filter::before {
  content: "";
  position: absolute;
  top: 0; right: 0; bottom: 0; left: 0;
  z-index: -1;
  background: inherit;
  filter: blur(10px);
}
.glass-by-backdrop-filter {
  backdrop-filter: blur(10px);
}
```

> 毛玻璃边框效果：

## 毛玻璃效果-透明边框

![16.4](http://127.0.0.1:8080/%23css/images/16.4.png)

```html
<div>I'm an element with a blurry border. This is created with an actual border on the pseudo-elements, the :before being blurred and :after clipped to the padding-box.</div>
```

```scss
$url: url(https://images.unsplash.com/photo-1544070078-a212eda27b49?ixlib=rb-1.2.1&q=85&fm=jpg&crop=entropy&cs=srgb&ixid=eyJhcHBfaWQiOjE0NTg5fQ);
$b: 1.5em; // border-width
$blur: blur(9px);

div {
  overflow: hidden;
  position: relative;
  padding: calc(1em + #{$b});
  max-width: 23em;
  color: #fff;
  font: 600 1.5em/ 1.375 segoe script, comic sans ms, cursive;
  text-shadow: 1px 1px #000;
  
  &:before, &:after {
    position: absolute;
    z-index: -1; /* put it *behind* parent */
    /* zero all offsets */
    top: 0; right: 0; bottom: 0; left: 0;
    border: solid $b rgba(#000, .03);
    background: $url 50%/ cover 
                  border-box /* background-origin */
                  padding-box /* background-clip */;
    content: ''
  }
  
  &:before {
    border-color: transparent;
    background-clip: border-box;
    /* -webkit-prefixed version 
     * still needed for 
     * some mobile browsers 💔😭 */
    -webkit-filter: $blur;
            filter: $blur;
  }
}
```

## 简易insatagram

![16.instagram](http://127.0.0.1:8080/%23css/images/16.instagram.png)

```html
<h1>Image Editor with CSS Filters and jQuery</h1>
<!--Form for collecting image URL -->
<form id="urlBox" class="center">
  <input class="url-box" type="url" id="imgUrl" placeholder="Paste any image link and start playing!">
  <input id="go" type="button" value="Go">
</form>

<hr color="grey">
<div class="sliders">
  <form id="imageEditor">
    <p>
      <label for="gs">Grayscale</label>
      <input id="gs" name="gs" type="range" min="0" max="100" value="0">
    </p>
    <p>
      <label for="blur">Blur</label>
      <input id="blur" name="blur" type="range" min="0" max="10" value="0">
    </p>
    <p>
      <label for="br">Exposure</label>
      <input id="br" name="br" type="range" min="0" max="200" value="100">
    </p>
    <p>
      <label for="ct">Contrast</label>
      <input id="ct" name="ct" type="range" min="0" max="200" value="100">
    </p>
    <p>
      <label for="huer">Hue Rotate</label>
      <input id="huer" name="huer" type="range" min="0" max="360" value="0">
    </p>
    <p>
      <label for="opacity">Opacity</label>
      <input id="opacity" name="opacity" type="range" min="0" max="100" value="100">
    </p>
    <p>
      <label for="invert">Invert</label>
      <input id="invert" name="invert" type="range" min="0" max="100" value="0">
    </p>
    <p>
      <label for="saturate">Saturate</label>
      <input id="saturate" name="saturate" type="range" min="0" max="500" value="100">
    </p>
    <p>
      <label for="sepia">Sepia</label>
      <input id="sepia" name="sepia" type="range" min="0" max="100" value="0">
    </p>
    <input type="reset" form="imageEditor" id="reset" value="Reset" />
  </form>
</div>	

<!--container where image will be loaded-->
<div id="imageContainer" class="center">
  <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/123941/stadium.jpg">
</div>

<p class="p">Demo by Vikas Lalwani. <a href="http://www.sitepoint.com/build-simple-image-editor-with-css-filters-jquery" target="_blank">See article</a>.</p>

```

```css
/* General styles for the page */ 
* {
  margin: 0;
  padding: 0;
}

body {
  background-color: #D2D7D3;
  font-family: monospace;
  margin: 0 auto;
  width: 960px;
}

h1 {
  margin: 25px 0 25px 0;
  font-size: 40px;
  text-align: center;
}

hr {
  margin: 20px 0;
}

form {
  text-align: center;
}

/* Styles for  URL box */ 

.url-box {
  background-color: transparent;
  display: inline-block;
  height: 30px;
  border: none;
  border-bottom: 4px solid #b3b3b1;
  padding: 0px 0px 0px 20px;
  margin: 0px 0px;
  width: 50%;
  outline: none;
  text-align: center;
  font-size: 15px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
}

#go {
  display: inline-block;
  height: 50px;
  width: 50px;
  background-color: transparent;
  padding: 0px;
  border: 4px solid #b3b3b1;
  border-radius: 50%;
  box-shadow: none;
  cursor: pointer;
  outline: none;
  text-align: center;
  font-size: 20px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
}

/* Styles for image container*/

#imageContainer {
  border: 2px solid grey;
  border-radius: 10px;
  padding: 5px;
  width: 65%;
  max-width: 600px;
  float: left;
  margin: 20px;
}

#imageContainer img {
  border-radius: 10px;
  width: 100%;
}

/* Styles for sliders*/

.sliders {
  float: left;
  border: 2px solid grey;
  border-radius: 10px;
  margin-top: 20px;
  margin-bottom: 20px;
  padding-left: 10px;
}

.sliders p {
  margin: 18px 0;
  vertical-align: middle;
}

.sliders label {
  display: inline-block;
  margin: 10px 0 0 0;
  width: 100px;
  font-size: 16px;
  color: #22313F;
  text-align: left;
  vertical-align: middle;
}

.sliders input {
  position: relative;
  margin: 10px 20px 0 10px;
  vertical-align: middle;
}

input[type=range] {
  /*removes default webkit styles*/
  -webkit-appearance: none;
  /*fix for FF unable to apply focus style bug */
  border-radius: 5px;
  /*required for proper track sizing in FF*/
  width: 150px;
}

input[type=range]::-webkit-slider-runnable-track {
  width: 300px;
  height: 7px;
  background: #ABB7B7;
  border: none;
  border-radius: 3px;
}

input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  border: none;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: #4B77BE;
  margin-top: -6px;
  vertical-align: middle;
}
input[type=range]:focus {
  outline: none;
}

input[type=range]:hover {
	cursor: pointer;
}


#reset {
  display: inline-block;
  height: 40px;
  width: 100px;
  background-color: transparent;
  padding: 0px;
  border: 4px solid #b3b3b1;
  border-radius: 10px;
  box-shadow: none;
  cursor: pointer;
  outline: none;
  text-align: center;
  font-size: 20px;
  font-family: monospace;
  font-weight: 100;
  color: #000;
  margin: 0 0 10px 0;
}

.p {
  clear: both;
  text-align: center;
  padding:  40px 0 40px;
}
```

```js
//on click of go(submit) button, addImage() will be called
$("#go").click(addImage);

//on pressing return, addImage() will be called
$("#urlBox").submit(addImage);


// editing image via css properties
function editImage() {
	var gs = $("#gs").val(); // grayscale
	var blur = $("#blur").val(); // blur
	var br = $("#br").val(); // brightness
	var ct = $("#ct").val(); // contrast
	var huer = $("#huer").val(); //hue-rotate
	var opacity = $("#opacity").val(); //opacity
	var invert = $("#invert").val(); //invert
	var saturate = $("#saturate").val(); //saturate
	var sepia = $("#sepia").val(); //sepia

	$("#imageContainer img").css(
    "filter", 'grayscale(' + gs+
    '%) blur(' + blur +
    'px) brightness(' + br +
    '%) contrast(' + ct +
    '%) hue-rotate(' + huer +
    'deg) opacity(' + opacity +
    '%) invert(' + invert +
    '%) saturate(' + saturate +
    '%) sepia(' + sepia + '%)'
  );

	$("#imageContainer img").css(
    "-webkit-filter", 'grayscale(' + gs+
    '%) blur(' + blur +
    'px) brightness(' + br +
    '%) contrast(' + ct +
    '%) hue-rotate(' + huer +
    'deg) opacity(' + opacity +
    '%) invert(' + invert +
    '%) saturate(' + saturate +
    '%) sepia(' + sepia + '%)'
  );
}

//When sliders change image will be updated via editImage() function
$("input[type=range]").change(editImage).mousemove(editImage);

// Reset sliders back to their original values on press of 'reset'
$('#imageEditor').on('reset', function () {
	setTimeout(function() {
		editImage();
	}, 0);
});

// adding an image via url box
function addImage(e) {
	var imgUrl = $("#imgUrl").val();
	if (imgUrl.length) {
		$("#imageContainer img").attr("src", imgUrl);
	}
	e.preventDefault();	
}
```

### 漫画风格

### 压缩体积

### 黑白照片视频复原

## 兼容性


## 总结

哇塞，这也太哇塞了吧，CSS绝绝子，yyds


买塞克 https://codepen.io/positlabs/pen/jbmqON
https://codepen.io/bldng/details/xVxrEy
碎片 https://codepen.io/bajjy/pen/vwrKk
hover 字体 https://codepen.io/adrianparr/details/AXdQNy
毛玻璃效果 https://codepen.io/KazuyoshiGoto/pen/nhstF
老照片 https://codepen.io/dudleystorey/pen/pKoqa